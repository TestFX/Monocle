# Engineer Notes 2023-09-29

## Updating the Monocle Code
Monocle is an OpenJFX project. When JavaFX was part of the JDK in Java 8,
the Monocle code was found in the OpenJDK code base. JavaFX was then moved to a 
stand-alone module by Java 11. Therefore, when updating the Monocle code there are
separate locations for Java 8 and Java 11+.

### Java 11+ Monocle Code

Source code for Monocle 11+ can be found in several places. 

#### Maven
https://repo1.maven.org/maven2/org/openjfx/javafx-graphics

#### GitHub
The following table links the Git branch for each LTS release. It is more 
appropriate to use the tag for a specific release, but these links will help 
you get started.

| LTS       | Java Code                                                                                                             | Resources                                                                                                                  |
|-----------|-----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
| JavaFX 21 | [Java Code](https://github.com/openjdk/jfx/tree/jfx21/modules/javafx.graphics/src/main/java/com/sun/glass/ui/monocle) | [Resources](https://github.com/openjdk/jfx/tree/jfx21/modules/javafx.graphics/src/main/resources/com/sun/glass/ui/monocle) |
| JavaFX 17 | [Java Code](https://github.com/openjdk/jfx/tree/jfx17/modules/javafx.graphics/src/main/java/com/sun/glass/ui/monocle) | [Resources](https://github.com/openjdk/jfx/tree/jfx17/modules/javafx.graphics/src/main/resources/com/sun/glass/ui/monocle) |
| JavaFX 11 | [Java Code](https://github.com/openjdk/jfx/tree/jfx11/modules/javafx.graphics/src/main/java/com/sun/glass/ui/monocle) | [Resources](https://github.com/openjdk/jfx/tree/jfx11/modules/javafx.graphics/src/main/resources/com/sun/glass/ui/monocle) |

Note that some JavaFX 8 tags are also in this repository. They are for very old 
versions and should not be needed.

### Java 8 Monocle Code

Source code for Monocle in Java 8 is a bit harder to find. Many distributions 
no longer include JavaFX even with a Java 8 build. BellSoft Liberica seems to 
be the most reasonable to work with: https://bell-sw.com/libericajdk/

1. Navigate to BellSoft Liberica Download Center: https://bell-sw.com/pages/downloads/
2. In the section 'DownloadLiberica JDK' select 'JDK 8 LTS'
3. Click the 'Source Code' link to download an archive of the source code
4. Unpack the source code archive
5. The Java code is in `openjfx/modules/graphics/src/main/java/com/sun/glass/ui/monocle`
6. The resources are in `openjfx/modules/graphics/src/main/resources/com/sun/glass/ui/monocle`

Prior versions can be found by using the 'All versions' link going back to JDK 8u202+8.

#### For Reference
The JavaFX releases available on GitHub
- openjdk/jfx: 8.0-b52 to 8u60-b08
- openjdk/jdk: jdk8-b01 to jdk8-b120


## Create Signed Bundle
Signed Maven bundles can be generated by building the project as usual and then
using the bundle.sh script to generate the bundle for deployment to Maven
Central.
1. On your local machine, navigate to the project home
2. Execute `./gradle clean build`
3. Execute `scripts/bundle.sh`
4. The signed bundle is located in the `build/bundles` folder.

## Uploading Maven Bundles for Monocle
1. Sign in to https://oss.sonatype.org (TestFX artifacts are hosted on the old oss.sontatype.org server)
2. In the guide on the left click on 'Staging Upload'
3. For 'Upload Mode' choose 'Artifact Bundle'
4. Click the 'Select Bundle to Upload...' button
5. Navigate to and select the signed bundle on your local machine
6. Click the 'Upload Bundle' button

After the bundle is uploaded, Maven Central will process the bundle. The results of the upload and processing can be viewed by
1. In the guide on the left click on 'Staging Repositories'
2. Select the repository corresponding to the bundle upload
3. In the tabbed pane select the 'Activity' tab
4. Review the actions taken and resolve any issues found
